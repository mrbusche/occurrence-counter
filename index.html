<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="description" content="Occurrence Counter"/>
    <meta name="author" content="Matt Busche"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <link rel="stylesheet" href="css/styles.css">
    <title>Occurrence Counter</title>
  </head>

  <body>
    <span id="contributeongithub">
      <a href="https://github.com/mrbusche/occurrenceCounter">Contribute on GitHub</a>
    </span>
    <h1>Occurrence Counter</h1>
    <h5>Supports return, pipe, or comma delimited lists</h5>
    <div class="flex-container">
      <div id="one" class="flex-child">
        <label for="data">
          <textarea id="data" rows="25" autofocus></textarea>
        </label>
      </div>
      <div id="results" class="flex-child right"></div>
    </div>

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130707543-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "UA-130707543-1");
      function calculate() {
        const data = document
          .getElementById("data")
          .value;
        const list = data.split(determineDelimiter(data));

        const countedItems = {};
        for (const item in list) {
          countedItems[list[item]] = (countedItems[list[item]] || 0) + 1;
        }

        let result = "";
        for (const i in countedItems) {
          result += i + " - " + countedItems[i] + "<br>";
        }
        document
          .getElementById("results")
          .innerHTML = result;
      }

      function determineDelimiter(data) {
        const returnCount = data
          .split("\n")
          .length;
        const commaCount = data
          .split(",")
          .length;
        const pipeCount = data
          .split("|")
          .length;

        if (returnCount > commaCount && returnCount > pipeCount) {
          return "\n";
        } else if (commaCount > pipeCount) {
          return ",";
        }
        return "|";
      }

      document
        .getElementById("data")
        .addEventListener("keyup", function () {
          calculate();
        });
    </script>
  </body>
</html>